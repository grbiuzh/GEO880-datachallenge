---
title: "Roe Deer Movement Data"
subtitle: "Prediction of future movement in Roe Deer"
author: "Tim FÃ¤ssler and Gregory Biland"
date: "5/3/2022"
output:
  html_document
---

```{r setup, include=FALSE}
library(knitr)
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

```{r message=FALSE, warning=FALSE, =FALSE, include=FALSE}
Sys.setenv(LANG = "en")
library(readr)        # to import tabular data (e.g. csv)
library(dplyr)        # to manipulate (tabular) data
library(sf)           # to handle spatial vector data
library(terra)        # To handle raster data
library(lubridate)    # To handle dates and times
library(grid)
library(gridExtra)
library(ggplot2)
library(randomNames)
library(caTools)
library(caret)

knitr::opts_chunk$set(
  message = F,
  fig.width = 7,
  fig.height = 6,
  pandoc.stack.size = "4g",
  fig.align = 'center',
  opts_chunk$set(tidy.opts=list(width.cutoff=60),tidy=TRUE)
)

dataFolder   <- here::here()   
RFolder      <- here::here()         
figureFolder <- here::here("figs") 
```

```{r}
deer <- read_delim(file.path(dataFolder, "all_deer_complete.csv")) %>% data.frame()
canton_zh <- st_read(file.path(dataFolder,"Gemeindegrenzen_-OGD/UP_KANTON_F.shp"))
```
## Abstract

## Introduction

```{r}
#deer <- deer %>% group_by(reh) %>% mutate(Name = randomNames(reh, ethnicity = 4)) #Give deer names
ZH_shp <- canton_zh %>% subset(select = c(geometry))

head(deer)
```

## Material and Methods

### Visualization

```{r}
deer <- deer %>% st_as_sf(coords = c("y", "x"), crs = 2056, remove = FALSE) %>% st_transform(crs = 2056)
canton_zh <- canton_zh %>% st_transform(crs = 2056)

ggplot()+
  geom_line(data = deer, aes(x=datetime_utc, y = reh))+
  ggtitle("Monitoring timespan for 15 different roe deer")+
  scale_y_discrete(limits=rev)+
  ylab("Deer")+
  xlab("Date")

ggplot()+
  geom_sf(data = canton_zh)+
  geom_point(data = deer, aes(x=longitude, y = latitude))+
  ggtitle("Tracking points for 15 different roe deer")

deer <- deer %>% st_drop_geometry()

```

```{r Test and Trainigdata}
set.seed(55)

split = sample.split(deer, SplitRatio = 0.8)
trainingset = subset(deer, split==TRUE)
testset = subset(deer, split==FALSE)

trainingset_clean <- select(trainingset, -c()) 
testset_clean <- select(testset, -c())
```


```{r ANN}
set.seed(54)

ann_model <- train(sex ~ ., data= trainingset_clean, method="nnet", maxit = 1, trace=FALSE, MaxNWts=2600)
ann_model

```



## Results


## Discussion
